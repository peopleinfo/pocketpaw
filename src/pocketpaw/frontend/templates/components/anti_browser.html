<!-- Anti-Browser Main View -->
<div
  class="absolute inset-0 z-10 flex flex-col pt-[72px] bg-[var(--bg-color)] animate-[fadeScaleIn_0.3s_ease-out]"
  x-show="view === 'anti-browser'"
>
  <!-- Header -->
  <div
    class="flex items-center justify-between px-6 py-4 border-b border-white/5 shrink-0 bg-black/20"
  >
    <div class="flex items-center gap-3">
      <div
        class="w-10 h-10 rounded-xl bg-accent/20 flex items-center justify-center shadow-lg shadow-accent/10"
      >
        <i data-lucide="shield" class="w-5 h-5 text-accent"></i>
      </div>
      <div>
        <h2 class="text-lg font-semibold text-white tracking-tight">
          Anti-Browser
        </h2>
        <p class="text-xs text-white/50">
          Manage isolated browser profiles and run actor templates
        </p>
      </div>
    </div>
    <div class="flex items-center gap-4">
      <div class="relative group">
        <i
          data-lucide="search"
          class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-white/30 group-focus-within:text-accent transition-colors"
        ></i>
        <input
          type="text"
          x-model="antiBrowser.search"
          placeholder="Search profiles..."
          class="pl-9 pr-4 py-2 bg-white/5 border border-white/10 rounded-xl text-sm text-white placeholder-white/30 focus:border-accent focus:bg-white/10 focus:outline-none w-64 transition-all"
        />
      </div>
      <button
        class="flex items-center gap-2 px-4 py-2 bg-accent text-white rounded-xl hover:bg-accent/90 transition-colors shadow-lg shadow-accent/20 hover:scale-105 active:scale-95 text-sm font-medium"
        @click="openAntiBrowserDrawer('create')"
      >
        <i data-lucide="plus" class="w-4 h-4"></i> New Profile
      </button>
    </div>
  </div>

  <!-- Content Area: Table -->
  <div
    class="flex-1 overflow-y-auto p-6 md:p-8"
    style="
      scrollbar-width: thin;
      scrollbar-color: rgba(255, 255, 255, 0.1) transparent;
    "
  >
    <!-- Empty State -->
    <template x-if="antiBrowser.profiles.length === 0 && !antiBrowser.loading">
      <div
        class="flex flex-col items-center justify-center h-[60vh] text-center"
      >
        <div
          class="w-20 h-20 rounded-[2rem] bg-white/5 flex items-center justify-center mb-6 shadow-xl shadow-black/40"
        >
          <i data-lucide="shield-off" class="w-10 h-10 text-white/20"></i>
        </div>
        <h3 class="text-xl font-semibold text-white/80 mb-3 tracking-tight">
          No Profiles Yet
        </h3>
        <p class="text-[13px] text-white/40 mb-8 max-w-sm leading-relaxed">
          Create isolated browser profiles with unique fingerprints for your
          scraping tasks to bypass bot protection.
        </p>
        <button
          class="px-6 py-3 bg-accent text-white rounded-xl hover:bg-accent/90 transition-all shadow-lg shadow-accent/20 hover:scale-105 active:scale-95 text-sm font-medium"
          @click="openAntiBrowserDrawer('create')"
        >
          Create First Profile
        </button>
      </div>
    </template>

    <!-- Table -->
    <template x-if="antiBrowser.profiles.length > 0">
      <div
        class="bg-black/20 border border-white/10 rounded-2xl overflow-hidden shadow-2xl"
      >
        <table class="w-full text-left border-collapse">
          <thead>
            <tr class="border-b border-white/10 bg-white/[0.03]">
              <th
                class="px-6 py-4 text-[11px] font-semibold uppercase tracking-wider text-white/40 w-12"
              >
                Status
              </th>
              <th
                class="px-6 py-4 text-[11px] font-semibold uppercase tracking-wider text-white/40"
              >
                Profile
              </th>
              <th
                class="px-6 py-4 text-[11px] font-semibold uppercase tracking-wider text-white/40"
              >
                Engine
              </th>
              <th
                class="px-6 py-4 text-[11px] font-semibold uppercase tracking-wider text-white/40"
              >
                Proxy
              </th>
              <th
                class="px-6 py-4 text-[11px] font-semibold uppercase tracking-wider text-white/40"
              >
                Last Used
              </th>
              <th
                class="px-6 py-4 text-[11px] font-semibold uppercase tracking-wider text-white/40 text-right"
              >
                Actions
              </th>
            </tr>
          </thead>
          <tbody class="divide-y divide-white/5">
            <template
              x-for="profile in filteredAntiBrowserProfiles()"
              :key="profile.id"
            >
              <tr
                class="group hover:bg-white/[0.04] transition-colors cursor-pointer"
                @click="selectAntiBrowserProfile(profile)"
              >
                <td class="px-6 py-4">
                  <div
                    class="w-8 h-8 rounded-lg flex items-center justify-center"
                    :class="profile.status === 'RUNNING' ? 'bg-green-500/20' : profile.status === 'ERROR' ? 'bg-red-500/20' : 'bg-white/5'"
                  >
                    <span
                      class="w-2.5 h-2.5 rounded-full inline-block"
                      :class="profile.status === 'RUNNING' ? 'bg-green-400 animate-pulse shadow-[0_0_10px_rgba(74,222,128,0.5)]' : profile.status === 'ERROR' ? 'bg-red-400' : 'bg-white/30'"
                    ></span>
                  </div>
                </td>
                <td class="px-6 py-4">
                  <div
                    class="font-medium text-[14px] text-white/90 mb-1"
                    x-text="profile.name"
                  ></div>
                  <div
                    class="text-[11px] text-white/40 truncate max-w-[200px]"
                    x-text="profile.start_url || 'No default URL'"
                  ></div>
                </td>
                <td class="px-6 py-4">
                  <span
                    class="px-3 py-1.5 rounded-lg bg-white/5 text-[11px] text-white/70 capitalize border border-white/5"
                    x-text="profile.plugin"
                  ></span>
                </td>
                <td class="px-6 py-4">
                  <template x-if="profile.proxy">
                    <span
                      class="inline-flex items-center gap-1.5 text-[11px] px-2.5 py-1 rounded bg-blue-500/10 text-blue-400/90 font-mono border border-blue-500/20"
                      ><i data-lucide="network" class="w-3 h-3"></i>Yes</span
                    >
                  </template>
                  <template x-if="!profile.proxy">
                    <span class="text-[12px] text-white/20">-</span>
                  </template>
                </td>
                <td
                  class="px-6 py-4 text-[12px] text-white/50"
                  x-text="profile.last_used_at ? new Date(profile.last_used_at).toLocaleDateString() : 'Never'"
                ></td>
                <td class="px-6 py-4 text-right">
                  <button
                    class="px-4 py-2 bg-white/5 text-white hover:bg-accent hover:text-white rounded-lg text-[12px] font-medium transition-all shadow-sm border border-white/10 group-hover:border-transparent group-hover:scale-105"
                    @click.stop="selectAntiBrowserProfile(profile)"
                  >
                    Launch
                  </button>
                </td>
              </tr>
            </template>
            <tr
              x-show="filteredAntiBrowserProfiles().length === 0 && antiBrowser.search"
            >
              <td
                colspan="6"
                class="px-6 py-12 text-center text-white/40 text-sm"
              >
                No profiles matched your search.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </template>
  </div>

  <!-- Slide-out Drawer Overlay -->
  <div
    class="fixed inset-0 z-[100] flex justify-end bg-black/60 backdrop-blur-sm transition-opacity"
    x-show="antiBrowser.drawerOpen"
    x-transition.opacity
    @click.self="antiBrowser.drawerOpen = false"
  >
    <!-- Drawer Panel -->
    <div
      class="h-full bg-[#1c1c1e] shadow-2xl flex flex-col border-l border-white/10 transition-[width] duration-300"
      :class="antiBrowser.drawerView === 'create' ? 'w-full' : 'w-[480px]'"
      x-show="antiBrowser.drawerOpen"
      x-transition:enter="transition ease-out duration-300 transform"
      x-transition:enter-start="translate-x-full"
      x-transition:enter-end="translate-x-0"
      x-transition:leave="transition ease-in duration-200 transform"
      x-transition:leave-start="translate-x-0"
      x-transition:leave-end="translate-x-full"
    >
      <!-- Header -->
      <div
        class="flex items-center justify-between px-6 py-5 border-b border-white/5 bg-black/20 shrink-0"
      >
        <div class="flex items-center gap-3">
          <template x-if="antiBrowser.drawerView === 'create'">
            <div class="flex items-center gap-3">
              <div
                class="w-8 h-8 bg-accent/20 rounded-lg flex items-center justify-center"
              >
                <i data-lucide="plus" class="w-4 h-4 text-accent"></i>
              </div>
              <h2 class="text-base font-semibold text-white">New Profile</h2>
            </div>
          </template>
          <template
            x-if="antiBrowser.selectedProfile && antiBrowser.drawerView !== 'create'"
          >
            <div class="flex items-center gap-3">
              <span
                class="w-3.5 h-3.5 rounded-full border-2 border-[#1c1c1e] shadow-sm"
                :class="antiBrowser.selectedProfile.status === 'RUNNING' ? 'bg-green-400 animate-pulse' : 'bg-white/30'"
              ></span>
              <h3
                class="text-base font-semibold tracking-tight text-white/90"
                x-text="antiBrowser.selectedProfile.name"
              ></h3>
              <span
                class="px-2 py-0.5 text-[9px] font-bold uppercase tracking-wider rounded-sm bg-white/10 text-white/40"
                x-text="antiBrowser.selectedProfile.plugin"
              ></span>
            </div>
          </template>
        </div>
        <div class="flex items-center gap-2">
          <template
            x-if="antiBrowser.selectedProfile && antiBrowser.drawerView !== 'create'"
          >
            <button
              class="p-2 text-white/40 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors"
              @click="deleteAntiBrowserProfile(antiBrowser.selectedProfile.id)"
              title="Delete Profile"
            >
              <i data-lucide="trash-2" class="w-4 h-4"></i>
            </button>
          </template>
          <button
            class="p-2 -mr-2 text-white/40 hover:text-white hover:bg-white/10 rounded-lg transition-colors"
            @click="antiBrowser.drawerOpen = false"
          >
            <i data-lucide="x" class="w-5 h-5"></i>
          </button>
        </div>
      </div>

      <!-- BODY (Create vs Detail) -->
      <div
        class="flex-1 overflow-y-auto p-6 md:p-8 relative"
        style="
          scrollbar-width: thin;
          scrollbar-color: rgba(255, 255, 255, 0.1) transparent;
        "
      >
        <!-- ===== Create Profile Form ===== -->
        <template x-if="antiBrowser.drawerView === 'create'">
          <div
            class="flex flex-col gap-6 animate-[fadeScaleIn_0.2s_ease-out] max-w-3xl w-full mx-auto pb-12"
          >
            <div>
              <label class="text-[12px] font-medium text-white/60 mb-1.5 block"
                >Name</label
              >
              <input
                type="text"
                x-model="antiBrowser.form.name"
                placeholder="e.g. news-reader"
                class="w-full px-4 py-3 bg-black/40 border border-white/10 rounded-xl text-sm text-white placeholder-white/30 focus:border-accent focus:outline-none transition-colors"
              />
            </div>
            <div>
              <label class="text-[12px] font-medium text-white/60 mb-1.5 block"
                >Start URL</label
              >
              <input
                type="text"
                x-model="antiBrowser.form.start_url"
                placeholder="https://..."
                class="w-full px-4 py-3 bg-black/40 border border-white/10 rounded-xl text-sm text-white placeholder-white/30 focus:border-accent focus:outline-none transition-colors"
              />
            </div>
            <div>
              <label class="text-[12px] font-medium text-white/60 mb-1.5 block"
                >Proxy</label
              >
              <input
                type="text"
                x-model="antiBrowser.form.proxy"
                placeholder="socks5://host:port or http://host:port"
                class="w-full px-4 py-3 bg-black/40 border border-white/10 rounded-xl text-sm text-white placeholder-white/30 focus:border-accent focus:outline-none font-mono transition-colors"
              />
            </div>
            <div class="grid grid-cols-3 gap-4">
              <div>
                <label
                  class="text-[12px] font-medium text-white/60 mb-1.5 block"
                  >OS</label
                >
                <select
                  x-model="antiBrowser.form.os_type"
                  class="w-full px-3 py-3 bg-black/40 border border-white/10 rounded-xl text-[13px] text-white focus:border-accent focus:outline-none transition-colors appearance-none"
                >
                  <option value="macos">macOS</option>
                  <option value="windows">Windows</option>
                  <option value="linux">Linux</option>
                </select>
              </div>
              <div>
                <label
                  class="text-[12px] font-medium text-white/60 mb-1.5 block"
                  >Browser</label
                >
                <select
                  x-model="antiBrowser.form.browser_type"
                  :disabled="antiBrowser.form.plugin === 'camoufox'"
                  class="w-full px-3 py-3 bg-black/40 border border-white/10 rounded-xl text-[13px] text-white focus:border-accent focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed transition-colors appearance-none"
                >
                  <option value="chromium">Chromium</option>
                  <option value="firefox">Firefox</option>
                </select>
              </div>
              <div>
                <label
                  class="text-[12px] font-medium text-white/60 mb-1.5 block"
                  >Plugin</label
                >
                <select
                  x-model="antiBrowser.form.plugin"
                  @change="if (antiBrowser.form.plugin === 'camoufox') antiBrowser.form.browser_type = 'firefox'"
                  class="w-full px-3 py-3 bg-black/40 border border-white/10 rounded-xl text-[13px] text-white focus:border-accent focus:outline-none transition-colors appearance-none"
                >
                  <template x-for="p in antiBrowser.plugins" :key="p.id">
                    <option
                      :value="p.id"
                      x-text="p.installed ? p.name : `${p.name} (Not Installed)`"
                    ></option>
                  </template>
                </select>
              </div>
            </div>

            <!-- Targeted Missing Plugin Installer -->
            <template
              x-if="antiBrowser.plugins.find(p => p.id === antiBrowser.form.plugin && !p.installed)"
            >
              <div
                class="px-4 py-3 bg-orange-500/10 border border-orange-500/20 rounded-xl shadow-sm -mt-2"
              >
                <div class="flex items-center justify-between">
                  <div class="flex items-center gap-2.5">
                    <i
                      data-lucide="alert-triangle"
                      class="w-4 h-4 text-orange-400"
                    ></i>
                    <span class="text-[12px] text-orange-400/90 font-medium"
                      >This plugin is missing and must be installed.</span
                    >
                  </div>
                  <button
                    @click="installAntiBrowserPlugin(antiBrowser.form.plugin)"
                    :disabled="antiBrowser.plugins.find(p => p.id === antiBrowser.form.plugin)?.installing"
                    class="px-3 py-1.5 bg-orange-500 hover:bg-orange-400 text-white rounded-lg text-[11px] font-medium transition-colors disabled:opacity-50 inline-flex items-center gap-1.5"
                  >
                    <span
                      x-show="!antiBrowser.plugins.find(p => p.id === antiBrowser.form.plugin)?.installing"
                      >Install Now</span
                    >
                    <span
                      x-show="antiBrowser.plugins.find(p => p.id === antiBrowser.form.plugin)?.installing"
                      ><i
                        data-lucide="loader-2"
                        class="w-3 h-3 animate-spin"
                      ></i>
                      Installing...</span
                    >
                  </button>
                </div>
              </div>
            </template>

            <div>
              <label class="text-[12px] font-medium text-white/60 mb-1.5 block"
                >Notes
                <span class="text-white/30 font-normal">(Optional)</span></label
              >
              <textarea
                x-model="antiBrowser.form.notes"
                placeholder="Any special remarks..."
                rows="2"
                class="w-full px-4 py-3 bg-black/40 border border-white/10 rounded-xl text-[13px] text-white placeholder-white/30 focus:border-accent focus:outline-none resize-none transition-colors"
              ></textarea>
            </div>
            <div
              class="flex items-center gap-3 mt-6 pt-6 border-t border-white/5"
            >
              <button
                @click="createAntiBrowserProfile()"
                :disabled="!antiBrowser.form.name.trim() || antiBrowser.creating || !antiBrowser.plugins.find(p => p.id === antiBrowser.form.plugin)?.installed"
                class="flex-1 py-3.5 bg-accent text-white font-medium rounded-xl hover:bg-accent/90 transition-all disabled:opacity-50 text-[14px] shadow-lg shadow-accent/20 hover:scale-[1.02] active:scale-[0.98]"
              >
                <span x-show="!antiBrowser.creating">Create Profile</span>
                <span x-show="antiBrowser.creating">Creating...</span>
              </button>
              <button
                class="px-6 py-3.5 text-[14px] font-medium bg-white/5 text-white/70 hover:text-white hover:bg-white/10 rounded-xl transition-colors"
                @click="antiBrowser.drawerOpen = false"
              >
                Cancel
              </button>
            </div>
          </div>
        </template>

        <!-- ===== Profile Detail & Release Area ===== -->
        <template
          x-if="antiBrowser.selectedProfile && antiBrowser.drawerView !== 'create'"
        >
          <div class="flex flex-col gap-8 animate-[fadeScaleIn_0.2s_ease-out]">
            <!-- Details Section -->
            <div>
              <h4
                class="text-[11px] font-semibold uppercase tracking-widest text-white/30 mb-4"
              >
                Profile Identity
              </h4>
              <div
                class="bg-black/20 rounded-2xl p-5 border border-white/5 shadow-inner"
              >
                <div class="flex items-center justify-between mb-4">
                  <span class="text-[12px] font-medium text-white/70"
                    >Assigned Fingerprint</span
                  >
                  <button
                    class="text-[11px] text-accent hover:text-accent/80 transition-colors flex items-center gap-1"
                    @click="regenerateAntiBrowserFingerprint(antiBrowser.selectedProfile.id)"
                  >
                    <i data-lucide="refresh-cw" class="w-3 h-3"></i> Regenerate
                  </button>
                </div>
                <template x-if="antiBrowser.selectedProfile.fingerprint">
                  <div
                    class="flex flex-col gap-3 text-[12px] font-mono text-white/60"
                  >
                    <div class="flex flex-col gap-1.5">
                      <span
                        class="text-white/40 text-[10px] uppercase font-sans tracking-wide"
                        >User Agent</span
                      >
                      <span
                        class="text-white/80 bg-white/[0.03] px-2.5 py-2 rounded-lg border border-white/5 break-words whitespace-pre-wrap leading-relaxed"
                        x-text="antiBrowser.selectedProfile.fingerprint.user_agent"
                      ></span>
                    </div>
                    <div
                      class="flex items-center justify-between mt-2 pt-3 border-t border-white/5"
                    >
                      <div class="flex flex-col gap-1">
                        <span
                          class="text-white/40 text-[10px] uppercase font-sans tracking-wide"
                          >Viewport</span
                        >
                        <span
                          class="text-white/80"
                          x-text="antiBrowser.selectedProfile.fingerprint.viewport ? antiBrowser.selectedProfile.fingerprint.viewport.width + 'Ã—' + antiBrowser.selectedProfile.fingerprint.viewport.height : 'N/A'"
                        ></span>
                      </div>
                      <div class="flex flex-col gap-1 text-right">
                        <span
                          class="text-white/40 text-[10px] uppercase font-sans tracking-wide"
                          >Locale</span
                        >
                        <span
                          class="text-white/80"
                          x-text="antiBrowser.selectedProfile.fingerprint.locale || 'en-US'"
                        ></span>
                      </div>
                    </div>
                  </div>
                </template>
              </div>
              <!-- Quick info -->
              <div class="grid grid-cols-2 gap-3 mt-3">
                <template x-if="antiBrowser.selectedProfile.proxy">
                  <div
                    class="bg-black/20 p-3 rounded-xl border border-white/5 flex flex-col gap-1"
                  >
                    <span
                      class="text-[10px] uppercase tracking-wide text-white/40 flex items-center gap-1.5"
                      ><i
                        data-lucide="network"
                        class="w-3 h-3 text-blue-400"
                      ></i>
                      Proxy</span
                    >
                    <span
                      class="text-white/80 font-mono text-[11px] truncate"
                      x-text="antiBrowser.selectedProfile.proxy"
                    ></span>
                  </div>
                </template>
                <template x-if="antiBrowser.selectedProfile.start_url">
                  <div
                    class="bg-black/20 p-3 rounded-xl border border-white/5 flex flex-col gap-1"
                    :class="!antiBrowser.selectedProfile.proxy ? 'col-span-2' : ''"
                  >
                    <span
                      class="text-[10px] uppercase tracking-wide text-white/40 flex items-center gap-1.5"
                      ><i data-lucide="link" class="w-3 h-3 text-white/40"></i>
                      Default URL</span
                    >
                    <span
                      class="text-white/80 text-[12px] truncate"
                      x-text="antiBrowser.selectedProfile.start_url"
                    ></span>
                  </div>
                </template>
              </div>
            </div>

            <!-- Launch Section -->
            <div>
              <h4
                class="text-[11px] font-semibold uppercase tracking-widest text-accent mb-4"
              >
                Launch Actors
              </h4>
              <div class="flex flex-col gap-3">
                <template x-for="actor in antiBrowser.actors" :key="actor.id">
                  <div
                    class="rounded-2xl cursor-pointer transition-all border overflow-hidden"
                    :class="antiBrowser.selectedActor === actor.id ? 'bg-accent-[0.03] border-accent/40 shadow-[0_0_15px_rgba(10,132,255,0.1)]' : 'bg-black/20 border-white/5 hover:border-white/20'"
                    @click="selectAntiBrowserActor(actor.id)"
                  >
                    <div class="flex items-center gap-4 p-4">
                      <div
                        class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center shrink-0 border border-white/5"
                      >
                        <i
                          :data-lucide="actor.icon"
                          class="w-5 h-5 text-white/70"
                          :class="antiBrowser.selectedActor === actor.id ? 'text-accent' : ''"
                        ></i>
                      </div>
                      <div class="flex-1 min-w-0">
                        <div
                          class="font-medium text-[14px] text-white/90 mb-0.5"
                          x-text="actor.name"
                        ></div>
                        <div
                          class="text-[11px] text-white/40 truncate"
                          x-text="actor.description"
                        ></div>
                      </div>
                      <i
                        data-lucide="chevron-down"
                        x-show="antiBrowser.selectedActor === actor.id"
                        class="w-5 h-5 text-accent shrink-0"
                      ></i>
                    </div>

                    <!-- Dynamic Form Options Embedded When Selected -->
                    <div
                      x-show="antiBrowser.selectedActor === actor.id"
                      x-transition
                      class="bg-black/40 p-5 border-t border-accent/20"
                      @click.stop
                    >
                      <div class="flex flex-col gap-4">
                        <template
                          x-for="(prop, key) in antiBrowser.actorSchema?.properties || {}"
                          :key="key"
                        >
                          <div>
                            <label
                              class="text-[11px] font-medium text-white/60 mb-1.5 block"
                              x-text="prop.title || key"
                            ></label>
                            <template
                              x-if="prop['ui:widget'] === 'textarea' || prop['ui:widget'] === 'code'"
                            >
                              <textarea
                                x-model="antiBrowser.actorInputs[key]"
                                :placeholder="prop.description || ''"
                                rows="3"
                                class="w-full px-4 py-3 bg-black/50 border border-white/10 rounded-xl text-[12px] text-white focus:border-accent focus:outline-none resize-none font-mono transition-colors shadow-inner"
                              ></textarea>
                            </template>
                            <template x-if="prop.enum">
                              <select
                                x-model="antiBrowser.actorInputs[key]"
                                class="w-full px-4 py-3 bg-black/50 border border-white/10 rounded-xl text-[12px] text-white focus:border-accent focus:outline-none transition-colors shadow-inner appearance-none"
                              >
                                <template x-for="opt in prop.enum" :key="opt">
                                  <option :value="opt" x-text="opt"></option>
                                </template>
                              </select>
                            </template>
                            <template x-if="prop.type === 'boolean'">
                              <label
                                class="flex items-center gap-3 cursor-pointer p-2 rounded-lg hover:bg-white/5 transition-colors group"
                              >
                                <input
                                  type="checkbox"
                                  x-model="antiBrowser.actorInputs[key]"
                                  class="w-4 h-4 rounded appearance-none border border-white/20 checked:bg-accent checked:border-accent relative transition-all before:content-[''] before:absolute before:inset-0 before:bg-[url('data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22white%22%20stroke-width%3D%223%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Cpolyline%20points%3D%2220%206%209%2017%204%2012%22%3E%3C%2Fpolyline%3E%3C%2Fsvg%3E')] before:opacity-0 checked:before:opacity-100 before:bg-no-repeat before:bg-center before:bg-[length:70%]"
                                />
                                <span
                                  class="text-[12px] text-white/70 group-hover:text-white transition-colors"
                                  x-text="prop.description || ''"
                                ></span>
                              </label>
                            </template>
                            <template
                              x-if="prop.type === 'integer' && !prop.enum"
                            >
                              <input
                                type="number"
                                x-model.number="antiBrowser.actorInputs[key]"
                                :placeholder="prop.default"
                                class="w-full px-4 py-3 bg-black/50 border border-white/10 rounded-xl text-[12px] text-white focus:border-accent focus:outline-none transition-colors shadow-inner"
                              />
                            </template>
                            <template
                              x-if="prop.type === 'string' && !prop.enum && prop['ui:widget'] !== 'textarea' && prop['ui:widget'] !== 'code'"
                            >
                              <input
                                type="text"
                                x-model="antiBrowser.actorInputs[key]"
                                :placeholder="prop.description || ''"
                                class="w-full px-4 py-3 bg-black/50 border border-white/10 rounded-xl text-[12px] text-white focus:border-accent focus:outline-none transition-colors shadow-inner"
                              />
                            </template>
                          </div>
                        </template>
                        <button
                          @click.prevent="runAntiBrowserActor()"
                          :disabled="antiBrowser.running"
                          class="mt-3 w-full py-3.5 bg-green-500 text-white font-semibold rounded-xl hover:bg-green-400 transition-all disabled:opacity-50 text-[14px] flex items-center justify-center gap-2 shadow-lg shadow-green-500/20 hover:scale-[1.02] active:scale-[0.98]"
                        >
                          <i data-lucide="play" class="w-5 h-5"></i>
                          <span x-show="!antiBrowser.running"
                            >Run Selected Actor</span
                          >
                          <span
                            x-show="antiBrowser.running"
                            class="animate-pulse"
                            >Task is running...</span
                          >
                        </button>
                      </div>
                    </div>
                  </div>
                </template>
              </div>
            </div>

            <!-- Last Results -->
            <template x-if="antiBrowser.lastResult">
              <div class="pt-2 animate-[fadeScaleIn_0.3s_ease-out]">
                <div class="flex items-center justify-between mb-4">
                  <h4
                    class="text-[11px] font-semibold uppercase tracking-widest text-white/30"
                  >
                    Execution Results
                  </h4>
                  <span
                    class="px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider shadow-sm border"
                    :class="antiBrowser.lastResult.status === 'success' ? 'bg-green-500/10 text-green-400 border-green-500/20' : 'bg-red-500/10 text-red-400 border-red-500/20'"
                    x-text="antiBrowser.lastResult.status"
                  ></span>
                </div>
                <div
                  class="bg-black/30 rounded-2xl p-4 border border-white/5 shadow-inner"
                >
                  <div
                    class="flex items-center justify-between text-[12px] mb-3 px-1"
                  >
                    <span class="text-white/40"
                      >Pages Explored:
                      <span
                        class="text-white/80 font-semibold"
                        x-text="antiBrowser.lastResult.pages_crawled"
                      ></span
                    ></span>
                    <span class="text-white/40"
                      >Items Extracted:
                      <span
                        class="text-white/80 font-semibold"
                        x-text="antiBrowser.lastResult.items_extracted"
                      ></span
                    ></span>
                  </div>
                  <template x-if="antiBrowser.lastResult.error">
                    <div
                      class="text-[12px] text-red-400 bg-red-400/10 border border-red-400/20 p-3 rounded-xl mb-2 flex items-start gap-2"
                    >
                      <i
                        data-lucide="alert-circle"
                        class="w-4 h-4 shrink-0 mt-0.5"
                      ></i>
                      <span
                        class="flex-1"
                        x-text="antiBrowser.lastResult.error"
                      ></span>
                    </div>
                  </template>
                  <template
                    x-if="antiBrowser.lastResult.data && antiBrowser.lastResult.data.length > 0"
                  >
                    <div
                      class="max-h-[300px] overflow-y-auto mt-2 bg-black/60 p-3 rounded-xl border border-white/5"
                    >
                      <pre
                        class="text-[11px] text-white/60 font-mono whitespace-pre-wrap leading-relaxed"
                        x-text="JSON.stringify(antiBrowser.lastResult.data, null, 2)"
                      ></pre>
                    </div>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </template>
      </div>
    </div>
  </div>
</div>
